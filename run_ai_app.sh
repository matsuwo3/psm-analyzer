#!/bin/bash

# PSMåˆ†æãƒ„ãƒ¼ãƒ«ï¼ˆAIç‰ˆï¼‰èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

echo "=================================="
echo "PSMåˆ†æãƒ„ãƒ¼ãƒ«ï¼ˆAIç‰ˆï¼‰ã‚’èµ·å‹•ã—ã¾ã™"
echo "=================================="
echo ""

# ç’°å¢ƒå¤‰æ•°ã®èª­ã¿è¾¼ã¿
if [ -f .env ]; then
    echo "âœ… .env ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ"
    export $(cat .env | grep -v '^#' | xargs)
else
    echo "âš ï¸  .env ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
    echo "   å¿…è¦ã«å¿œã˜ã¦ env.template ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ .env ã‚’ä½œæˆã—ã¦ãã ã•ã„"
fi

echo ""

# ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒã‚§ãƒƒã‚¯
echo "ğŸ“¦ ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç¢ºèªä¸­..."
if ! pip show streamlit &> /dev/null; then
    echo "âŒ StreamlitãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“"
    echo "   ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ï¼š"
    echo "   pip install -r requirements_ai.txt"
    exit 1
fi

echo "âœ… ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸OK"
echo ""

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•
echo "ğŸš€ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•ã—ã¾ã™..."
echo "   ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:8501 ãŒé–‹ãã¾ã™"
echo ""
echo "   çµ‚äº†ã™ã‚‹ã«ã¯ Ctrl+C ã‚’æŠ¼ã—ã¦ãã ã•ã„"
echo ""

streamlit run psm_analyzer_ai.py --server.port 8501 --server.headless false
