# PSM分析ツール（AI版）クイックスタート

このガイドでは、5分でPSM分析ツールを起動し、最初のレポートを生成する方法を説明します。

## 📋 準備するもの

1. Python 3.8以上がインストールされていること
2. Anthropic Claude APIキー（[こちら](https://console.anthropic.com/)で取得）
3. PSMアンケートデータのCSVファイル（なければサンプルデータを使用）

## 🚀 5分でスタート

### ステップ1: インストール（2分）

```bash
# ディレクトリに移動
cd psm-analyzer

# 依存パッケージをインストール
pip install -r requirements_ai.txt
```

### ステップ2: アプリケーションを起動（1分）

#### 方法A: 起動スクリプトを使用（推奨）

```bash
# 実行権限を付与（初回のみ）
chmod +x run_ai_app.sh

# アプリケーションを起動
./run_ai_app.sh
```

#### 方法B: 直接Streamlitを実行

```bash
streamlit run psm_analyzer_ai.py --server.port 8501
```

ブラウザで `http://localhost:8501` が自動的に開きます。

### ステップ3: 分析を実行（2分）

1. **APIキーを入力**
   - 左サイドバーの「🔑 Claude API設定」にAPIキーを貼り付け

2. **CSVファイルをアップロード**
   - 左サイドバーの「📁 データアップロード」から`sample_data.csv`を選択
   - または、独自のCSVファイルをアップロード

3. **列を選択**
   - 必須列を選択：
     - 「安い」価格 → `安い価格`
     - 「お買い得」価格 → `お買い得価格`
     - 「高い」価格 → `高い価格`
     - 「高すぎる」価格 → `高すぎる価格`
   - オプション：カテゴリ列を選択（例：`性別`、`年齢`）

4. **分析を実行**
   - 「🚀 分析を実行」ボタンをクリック
   - 30秒程度待つとAI分析が完了

5. **結果を確認**
   - AIインサイトを読む
   - グラフで価格ポイントを確認
   - 統計テーブルをチェック

6. **レポートをダウンロード**
   - 「📥 Excelレポートをダウンロード」ボタンをクリック

これで完了です！

## 📊 サンプルデータで試す

プロジェクトには `sample_data.csv` が含まれています：

- 20件のサンプル回答
- 4つの価格列（安い、お買い得、高い、高すぎる）
- 3つのカテゴリ列（性別、年齢、利用頻度）

このファイルを使って、すぐにツールの機能を試せます。

## 🔧 環境変数を使用（オプション）

APIキーを毎回入力したくない場合：

```bash
# env.template をコピー
cp env.template .env

# .env を編集してAPIキーを設定
nano .env
# または
open .env
```

`.env`の内容：

```
ANTHROPIC_API_KEY=sk-ant-api03-あなたのAPIキーをここに入力
```

これで、起動時に自動的にAPIキーが読み込まれます。

## 💡 CSVデータの準備

### 必須列

CSVファイルには以下の4つの数値列が必要です：

| 質問 | 列名（例） |
|------|-----------|
| この価格だと「安い」と感じる価格は？ | 安い価格 |
| この価格だと「お買い得」と感じる価格は？ | お買い得価格 |
| この価格だと「高い」と感じる価格は？ | 高い価格 |
| この価格だと「高すぎる」と感じる価格は？ | 高すぎる価格 |

### オプション列

セグメント分析のため、以下のような列を追加できます：

- 性別（男性/女性）
- 年齢層（20代/30代/40代など）
- 利用頻度（週1回/月2-3回など）
- 地域、職業、収入層など

### データ形式の例

```csv
ID,性別,年齢,利用頻度,安い価格,お買い得価格,高い価格,高すぎる価格
1,男性,25,週1回,3000,4000,6000,8000
2,女性,32,月2-3回,3500,4500,7000,9000
3,男性,45,月1回,2500,3500,5500,7500
...
```

## ❓ よくある質問

### Q1: APIキーはどこで取得できますか？

A: [Anthropic Console](https://console.anthropic.com/)でアカウントを作成し、APIキーを発行してください。

### Q2: 無料で使えますか？

A: ツール自体は無料ですが、Claude APIの使用には料金がかかります。詳細は[Anthropic料金ページ](https://www.anthropic.com/pricing)を参照してください。

### Q3: データの最小件数は？

A: 最低10件の有効なデータが必要です。統計的に信頼性のある結果を得るには、50件以上を推奨します。

### Q4: Excel以外の形式でエクスポートできますか？

A: 現在はExcel形式のみです。将来のバージョンでPDF出力を追加予定です。

### Q5: オフラインで使用できますか？

A: PSM分析自体はオフラインでも動作しますが、AI分析にはインターネット接続が必要です。

### Q6: データのプライバシーは守られますか？

A: はい。アップロードしたデータはメモリ上でのみ処理され、サーバーには保存されません。セッション終了時に自動的に破棄されます。

## 🛠️ トラブルシューティング

### ポート8501が使用中の場合

```bash
# 別のポートで起動
streamlit run psm_analyzer_ai.py --server.port 8502
```

### パッケージのインストールエラー

```bash
# pipをアップグレード
pip install --upgrade pip

# 再度インストール
pip install -r requirements_ai.txt
```

### ブラウザが自動的に開かない場合

手動で `http://localhost:8501` をブラウザで開いてください。

## 📚 次のステップ

クイックスタートを完了したら、以下のドキュメントを参照してください：

- [README_AI.md](README_AI.md) - 詳細な機能説明
- [TASK_03.md](../TASK_03.md) - 実装仕様書
- [Streamlit ドキュメント](https://docs.streamlit.io/) - カスタマイズ方法

## 🎉 お疲れ様でした！

これで、PSM分析ツールを使用する準備が整いました。独自のデータで分析を試してみてください。

---

**ヒント**: 初めて使う場合は、まず `sample_data.csv` で動作を確認してから、独自のデータを使用することをお勧めします。
